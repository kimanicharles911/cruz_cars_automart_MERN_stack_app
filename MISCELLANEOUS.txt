npm i --save cors dotenv express mongoose
npm i --save-dev nodemon

npm i --save bson
npm i --save multer

cruzCars

Image Uploading Resources (Frontend & Backend)
==============================================>
1. Upload and Retrieve Image on MongoDB using Mongoose
https://www.geeksforgeeks.org/upload-and-retrieve-image-on-mongodb-using-mongoose/
2. Node.js get file extension
https://stackoverflow.com/a/67934955/9497346
3. How to upload/store images in MongoDB using Node.js, Express & Multer
https://www.bezkoder.com/node-js-upload-store-images-mongodb/
4. https://khanasadkhan48.medium.com/. how-to-upload-a-image-to-react-express-and-how-to-store-it-in-mongodb-using-buffer-type-e82d5751da79
5. https://www.youtube.com/watch?v=KoWTJ5XiYm4
6. https://www.youtube.com/watch?v=SqbrovwhZ_o
7. https://www.youtube.com/watch?v=b6Oe2puTdMQ
8. https://attacomsian.com/blog/uploading-files-nodejs-express

Got dummy car from: https://www.alamy.com/crash-test-dummy-changing-car-wheel-3d-illustration-image382502779.html




{
  "modelSpec": 2012
  "makeSpec": "GMC Sierra 1500 SLT"
  "sellingPrice": 29998
  "mileage": 59000
  "registrationNumber": "KDD 750C",
  "owner":"Hillary Clement",
  "address":"100, Baraka Rd, Dar-es-salaam"
}


Deployment
===========>
* Git does not track empty folders so ensure you've manually added a little dummy data into any empty folder that is used by the application. For example those used by multer. In this case I added a dummy car image in the uploadedImages folder. This prevents POST, PATCH and PUT request errors on heroku.
* Add this in package.json (backend):
  "engines": {
    "node": "16.13.2",
    "npm": "8.1.2"
  },
  In scripts:
    "heroku-postbuild": "NPM_CONFIG_PRODUCTION=false npm install --prefix frontend && npm run build --prefix frontend"
  Change scripts start from using nodemon to
    "start": "node app.js",

* Add this in app.js  (backend):
if(process.env.NODE_ENV === 'production'){
  app.use(express.static('frontend/build'));
  app.get('*', (req, res) => {
    res.sendFile(path.resolve(__dirname, 'frontend', 'build', 'index.html'));
  })
}

* Then run the following terminal commands
  install heroku
  heroku login
  touch Procfile

* Add this line in the Procfile which will depend with the name of your server file which in my case is app.js:
  web: node app.js

* Then run the following terminal commands:
  heroku create cruzcarsautomartmern
  git add . 
  git commit -m"first deploy to heroku"
  ## optional for pushing to github: git push -u origin master
  git push heroku master

* Set MongoDB Password by first:
  • Replace the .env variable in the mongoose connection string with the password itself.
  • Do not use && chained git commands.
  • git add .
  • git status
  • git commit -m"attempt to deploy to heroku"
  • git status
  • git push heroku master #only pushes to heroku but not github
  • git reset HEAD~1 #destroys the commit that had the mongoDB password exposed to version control
  • git status
  • Disable Heroku from reverting to an app.js file without a raw password by excluding app.js from version control w/:
    git update-index --assume-unchanged "app.js"
    Undo it w/: git update-index --no-assume-unchanged "app.js"


